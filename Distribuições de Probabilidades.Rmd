---
title: "Distribuições de Probabilidade"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

Obs:

--------------------------------------------------

d calcula a densidade de probabilidade f(x) no ponto;

p calcula a função de probabilidade acumulada F(x)
 no ponto;

q calcula o quantil correspondente a uma dada probabilidade;

r gera uma amostra aleatória da distribuição.

--------------------------------------------------

*Distribuição Binomial*
```{r}
moeda <- data.frame('cara'=
             rep(c('0',"1","2","3","4"), 
                  c(1, 4, 6, 4, 1)))
```
```{r}
require(ggplot2)
```
```{r}
ggplot(moeda, aes(x = cara, y=..count../sum(..count..), fill = cara)) +
  geom_bar(width=0.1) +
  labs(title = "Lançamento de uma moeda quatro vezes",
     x = "Quantidade de caras",
     y = "Probabilidade",
     fill='QTD caras')
```
A probabilidade de ocorrer cara 2 vezes é a maior. Nas 16 observações, a maioria das vezes apresentou a moeda cara ocorrendo 2 vezes em cada 4 lançamentos. 

Agora, o calculo de algumas probabilidades envolvendo esta distribuição. 

Probablidade(x = Ocorrer exatamente 2 caras em 4 lançamentos de uma moeda.)
```{r}
dbinom(x=2, #Calcula a probabilidade de P(X=x)
       size=4, #Quantidade total de lançamentos
       prob=0.5, #Probabilidade inicial de ocorrer o sucesso
       log = FALSE)
```
p(Ocorrer no máximo 3 caras em 4 lançamentos de uma moeda.)
```{r}
pbinom(q=3, #Quantidade de caras
        size=4, #Quantidade total de lançamentos
        prob=0.5, #Probabilidade inicial de ocorrência (lançar uma moeda uma única vez, qual a probabilidade de ocorrer cara)
        lower.tail = TRUE #P[X<= x]
        )
```
Plot do gráfico de probabilidades
```{r}
caras <- 0:4
probabilidade <- dbinom(x=caras,   # Quantidade de sucessos
                        size = 4,  # Quantidade de lançamentos
                        prob=0.5)  # Probabilidade a priori de sucesso

plot(caras, probabilidade, 
     type='h',   # Desenha uma linha vertical
     col='red',   # Cor da linha
     lwd=3)      # Espessura da linha/ponto

```
Exemplo 1 : Suponha que numa linha de produção a probabilidade de se obter uma peça defeituosa (sucesso) é p=0,5. 

Toma-se uma amostra de 10 peças para serem inspecionadas. Em que X é o número de peças defeituosa produzidas em único dia.

Qual é a probabilidade de um remessa com 10 peças conter pelo menos quatro peças defeituosa.

Note que, Pelos quatro significa, P[X≥4], isto é equivalente a 1−P[X<4] ou 1−P[X≤3]

```{r}
 pbinom(q=3, #Quantidade de peças defeituosas
        size=10, #Quantidade total de peças
        prob=0.5, #Probabilidade inicial de peça defeituosa
        lower.tail = FALSE #P[X> x]
        )
```
Exemplo 2: Considere nascimentos de 4 filhotes de coelhos de uma determinada raça. Nesta raça há um distúrbio genético e a probabilidade de nascer fêmea é 5/8.

Gráfico de Probabilidades:

```{r}
femeas <- 0:4
probabilidade <- dbinom(x=femeas,   # Quantidade de sucessos
                        size = 4,   # Quantidade de nascimento
                        prob=5/8)   # Probabilidade a priori de sucesso

plot(femeas, probabilidade, 
     type='h',   # Desenha uma linha vertical
     col='red',   # Cor da linha
     lwd=3)      # Espessura da linha/ponto
```
Probabilidade de nascer pelo menos três fêmeas.P[X≥3]=P[X>2] = 1 - P[X<3] ou 1−P[X≤2]

```{r}
 pbinom(q=2,         # Quantidade de fêmeas
        size=4,      # Quantidade total de filhores
        prob=5/8,    # Probabilidade inicial de fêmea
        lower.tail = FALSE #P[X> x]
        )
```
*Distribuição de Poisson*

Problema: Nos últimos 30 dias foram registrados a quantidade de acidentes por dia em uma determinada cidade.
```{r}
acidente <- data.frame('acd'= c(9, 6, 9, 11, 10, 10, 6, 10, 9, 4, 8, 10,
                                10, 7, 9, 11, 4, 6, 11, 8, 5, 3, 5, 9, 6))

table(acidente$acd)
```
Verificando o Plot
```{r}
ggplot(acidente, aes(x = as.factor(acd), y=..count../sum(..count..),
                     fill = as.factor(acd))) +
  geom_bar(width=0.1) +
  labs(title = "Acidentes por dia",
     x = "Quantidade de acidentes",
     y = "Frequência",
     fill='QTD acidentes')
```
A questão aqui é que não temos condições de afirmar qual a quantidade máxima de acidentes que podem ocorrer em um único dia.

Desta forma, o modelos de Poisson é o sugerido para dados de contagem dentro de um intervalo (temporal ou espacial) fixo.
```{r}
# Média de acidentes por dia
mean(acidente$acd)
# DP da qtd de acidentes por dia
sd(acidente$acd)
```
Observando o gráfico parece razoável aformar que: a probabilidade de ocorrer 9 acidentes em um único dia é de 0,20.

Mas, olhando para a amostra, não somos capazes de afirmar qual a probabilidade de ocorrer 12 acidentes em um único dia.

Para responder a este questionamente, temos que fazer o uso de um modelo probabilístico, neste caso, Poisson.

Neste modelo, uma estimativa relacionada ao parâmetro λ deve ser a média amostral. Logo, podemos utilizar λ=8
 
P( x = Ocorrer 12 acidentes em um único dia)
```{r}
dpois(x = 12,
      lambda = 8)
```
Visualizando gráficamente as probabilidaes
```{r}
acid_dia <- 0:20
probs <- dpois(x = acid_dia,
              lambda = 8)

plot(acid_dia, probs, 
     type='h',   # Desenha uma linha vertical
     col='red',   # Cor da linha
     lwd=4)      # Espessura da linha/ponto
```
Exemplo: Uma empresa de telefonia recebe, em média, cinco chamadas por minuto. 

O gráfico de probabilidades:
```{r}
tel_min <- 0:10
probs <- dpois(x = tel_min,
              lambda = 5)

plot(tel_min, probs, 
     type='h',   # Desenha uma linha vertical
     col='red',   # Cor da linha
     lwd=4)      # Espessura da linha/ponto
```
A probabilidade de que a empresa não receba chamada durante um intervalo de um minuto.
```{r}
dpois(x = 0, lambda = 5)
```
Algumas outras distribuições discretas
```{r}
# Binomial Negativa        dnbinom(n,size, prob)

# Geométrica               dgeom(n,prob)

# Hipergeometrica          dhyper(nn, m, n, k)
```

*Distribuição Normal*

```{r}
clim_dou <- read.csv2("C:/Users/Marcello/Downloads/clim_dou.csv")

colnames(clim_dou)
```
Vamos selecionar apenas o mês de janeiro
```{r}
jan = subset(clim_dou, Meses==1)
```
Vamos construir o gráfico de histograma para a temperatura máxima diária
```{r}
ggplot(jan, aes(x = Tem_max, ..density..)) +
  
  geom_histogram(binwidth = 1,     # Amplitude da classe
                 fill = 'dodgerblue',
                 color = 'black') +
  
  labs(title = "Distribuição da temperatura máxima diária",
       x = "Temperatura Máxima (º C)",
       y = "Densidade") +
  
  geom_density(alpha = 0.5)+     # Linha de densidade
  
  theme_light()
```
Problema: Como calcular a probabilidade, em um único dia, da temperatura máxima ser superior a 36ºC?

Neste problema temos o cálculo de área, o qual envolve o cálculo de integral. Mas qual função devo integrar? Para responder a este questionamento, vamos verificar se a função de densidade Normal é adequada para modelar esta variável.
```{r}
ggplot(jan, aes(x = Tem_max)) +
  
  geom_histogram(aes(y = ..density..),
                 binwidth = 1,     # Amplitude da classe
                 fill = 'dodgerblue',
                 color = 'black') +
  
  labs(title = "Distribuição da temperatura máxima diária",
       x = "Temperatura Máxima (º C)",
       y = "Densidade") +
  
  geom_density(alpha = 0.5)+     # Linha de densidade
  
  stat_function(fun = dnorm, color='red', size = 2,
                args = list(mean = mean(jan$Tem_max),
                            sd = sd(jan$Tem_max)))+   # Linha de densidade da distribuição Normal
  
  theme_light()
```

```{r}
##  média de janeiro
mean(jan$Tem_max)
## desvio padrão de janeiro
sd(jan$Tem_max)

```
Então calculamos a probabilidade seguindo o modelo normal.
```{r}
pnorm(q = 36,        # x=36
      mean = 31.71,  # média
      sd = 2.41,     # Desvio padrão
      lower.tail = FALSE # Calcula P[X > x]
      )
```
Assim, a temperatura máxima em um único dia exceder 36 ºC é de 0,04

Agora a probabilidade da temperatura máxima em um único dia em janeiro ser Inferior a 30 ºC
```{r}
pnorm(q = 30,        # x=30
      mean = 31.71,  # média
      sd = 2.41,     # Desvio padrão
      lower.tail = TRUE # Calcula P[X ??? x]
      )
```
Agora a probabilidade da temperatura máxima em um único dia em janeiro Está entre 30 ºC e 35 ºC
```{r}
pnorm(q = c(30, 35),        # x=30
      mean = 31.71,  # média
      sd = 2.41,     # Desvio padrão
      lower.tail = TRUE # Calcula P[X ??? x]
      )
```
```{r}
0.9138963 - 0.2389936
```
Agora para a temperatura mínima diária de janeiro, é construido um gráfico histograma em que seja possível analisar se a distribuição Normal é adequada para modelar a temperatura mínima
```{r}
ggplot(jan, aes(x = Tem_min)) +
  
  geom_histogram(aes(y = ..density..),
                 binwidth = 1,     # Amplitude da classe
                 fill = 'green',
                 color = 'gray60') +
  
  labs(title = "Distribuição da temperatura mínima diária",
       x = "Temperatura mínima (º C)",
       y = "Densidade") +
  
  geom_density(alpha = 0.5)+     # Linha de densidade
  
  stat_function(fun = dnorm, color='red', size = 2,
                args = list(mean = mean(jan$Tem_min),
                            sd = sd(jan$Tem_min)))+   # Linha de densidade da distribuição Normal
  
  theme_light()
```
Probabilidade da temperatura mínima em um único dia de janeiro ser inferior a 20 ºC
```{r}
## Média desse modelo
mean(jan$Tem_min)
## desvio padrão desse modelo
sd(jan$Tem_min)
```
```{r}
pnorm(q = 20,        # x=20
      mean = 21.02,  # média
      sd = 1.61,     # Desvio padrão
      lower.tail = TRUE # Calcula P[X ??? x]
      )
```
Probabilidade da temperatura mínima em um único dia de janeiro ser superior a 22 ºC
```{r}
pnorm(q = 22,            # x=22
      mean = 21.02,      # média
      sd = 1.61,         # Desvio padrão
      lower.tail = FALSE # Calcula P[X > x]
      )
```
*Distribuição Exponencial*

Exemplo: O tempo até a falha do ventilador de motores a diesel tem uma distribuição Exponencial com parâmetro λ=1/28700 horas. 

Qual a probabilidade de um destes ventiladores falhar nas primeiras 24000 horas de funcionamento?

```{r}
x<- 24000
razao<- 1/28700
prob<-pexp(x,razao);prob
```
Ou seja, a probabilidade de um destes ventiladores falhar nas primeiras 24 mil horas de funcionamento é de, aproximadamente, 56,7%

*Quantil de uma Distribuição*

```{r}
qf(0.975,12,10) # Distribuição F
qt(0.9,10) # Distribuição T
qchisq(0.975,12) # Distribuição qui-quadrado
qnorm(0.95,120,15) # Exemplo da normal : Qual deve ser o tempo de prova de modo a permitir que 95% dos vestibulandos terminem no prazo estipulado?


```
*Gerar números aleatórios de uma distribuição de interesse*

```{r}
n=5
t <- rt(n,10);t # Distribuição T

normalp <- rnorm(10);normalp # Distribuição Normal Padrão

normal <- rnorm(10,2,3); normal # Distribuição Normal

bino<-rbinom(10,10,0.3);bino # Distribuição Binomial
```
```{r}
# Outras Distribuições

#Uniforme          runif(n, min=0, max=1) 
#Exponencial       rexp(n, rate=1) 
#F                 rf(n, df1, df2) 
#Quiquadrado       rchisq(n, df) 
#Gama              rgamma(n, shape, scale=1) 
#Beta              rbeta(n, shape1, shape2) beta
#Log- Normal       rlnorm(n, meanlog=0, sdlog=1) lognormal
#Cauchy            rcauchy(n, location=0, scale=1) Cauchy
```



Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.
